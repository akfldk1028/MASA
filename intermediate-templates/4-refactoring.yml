name: "ğŸ”§ Code Refactoring Assistant"
on:
  schedule:
    - cron: '0 2 * * 0'  # ë§¤ì£¼ ì¼ìš”ì¼ ìƒˆë²½ 2ì‹œ
  issue_comment:
    types: [created]
  workflow_dispatch:
    inputs:
      target_files:
        description: 'ë¦¬íŒ©í† ë§í•  íŒŒì¼ë“¤ (ì‰¼í‘œë¡œ êµ¬ë¶„, ë¹„ì–´ìˆìœ¼ë©´ ì „ì²´ ë¶„ì„)'
        required: false
        default: ''
      focus_area:
        description: 'ì§‘ì¤‘í•  ë¦¬íŒ©í† ë§ ì˜ì—­'
        required: false
        default: 'all'
        type: choice
        options:
        - all
        - performance
        - readability
        - maintainability
        - security

jobs:
  refactoring:
    if: |
      github.event_name == 'schedule' ||
      github.event_name == 'workflow_dispatch' ||
      (github.event_name == 'issue_comment' && contains(github.event.comment.body, '@claude refactor'))
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
      issues: write
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Determine refactoring scope
        id: scope
        run: |
          echo "Determining refactoring scope..."
          
          if [ "${{ github.event_name }}" = "workflow_dispatch" ]; then
            TARGET_FILES="${{ github.event.inputs.target_files }}"
            FOCUS_AREA="${{ github.event.inputs.focus_area }}"
          elif [ "${{ github.event_name }}" = "issue_comment" ]; then
            # ì½”ë©˜íŠ¸ì—ì„œ íŒŒì¼ëª… ì¶”ì¶œ ì‹œë„
            TARGET_FILES=$(echo "${{ github.event.comment.body }}" | grep -oP '(?<=@claude refactor\s).*' | head -1)
            FOCUS_AREA="all"
          else
            # ìŠ¤ì¼€ì¤„ ì‹¤í–‰ - ì „ì²´ ì½”ë“œë² ì´ìŠ¤ ë¶„ì„í•˜ë˜ ìµœê·¼ ìˆ˜ì •ëœ íŒŒì¼ ìš°ì„ 
            TARGET_FILES=""
            FOCUS_AREA="all"
          fi
          
          echo "target_files=$TARGET_FILES" >> $GITHUB_OUTPUT
          echo "focus_area=$FOCUS_AREA" >> $GITHUB_OUTPUT
          
          # ë¶„ì„í•  íŒŒì¼ ëª©ë¡ ìƒì„±
          if [ -z "$TARGET_FILES" ]; then
            # ì „ì²´ ë¶„ì„ - ìµœê·¼ 30ì¼ ë‚´ ìˆ˜ì •ëœ íŒŒì¼ë“¤ ìš°ì„ 
            git log --since="30 days ago" --name-only --pretty=format: | sort -u | grep -E '\.(js|ts|py|java|go|rs|php|cpp|c)$' | head -20 > files_to_analyze.txt
            if [ ! -s files_to_analyze.txt ]; then
              # ìµœê·¼ ìˆ˜ì •ì´ ì—†ë‹¤ë©´ ì „ì²´ ì½”ë“œ íŒŒì¼ ìƒ˜í”Œë§
              find . -name "*.js" -o -name "*.ts" -o -name "*.py" -o -name "*.java" -o -name "*.go" -o -name "*.rs" | head -15 > files_to_analyze.txt
            fi
          else
            # íŠ¹ì • íŒŒì¼ë“¤ ë¶„ì„
            echo "$TARGET_FILES" | tr ',' '\n' > files_to_analyze.txt
          fi
          
          echo "ğŸ“‚ ë¶„ì„ ëŒ€ìƒ íŒŒì¼:"
          cat files_to_analyze.txt

      - name: Analyze code quality
        id: analyze
        run: |
          echo "ğŸ” ì½”ë“œ í’ˆì§ˆ ë¶„ì„ ì¤‘..."
          
          # ì½”ë“œ ë³µì¡ë„ ë¶„ì„ (ê°„ë‹¨í•œ metrics)
          echo "## ì½”ë“œ ë³µì¡ë„ ë¶„ì„" > code_analysis.md
          echo "" >> code_analysis.md
          
          while read -r file; do
            if [ -f "$file" ]; then
              lines=$(wc -l < "$file")
              functions=$(grep -E '(function|def|class|func)' "$file" | wc -l)
              echo "- **$file**: $lines lines, $functions functions/classes" >> code_analysis.md
            fi
          done < files_to_analyze.txt
          
          echo "ë¶„ì„ ì™„ë£Œ"

      - name: Run Code Refactoring
        id: claude-refactor
        uses: ./
        with:
          prompt: |
            ğŸ”§ **ì½”ë“œ ë¦¬íŒ©í† ë§ ìˆ˜í–‰**
            
            **ëª©í‘œ**: ì½”ë“œ í’ˆì§ˆ ê°œì„ ì„ í†µí•œ ìœ ì§€ë³´ìˆ˜ì„±ê³¼ ì„±ëŠ¥ í–¥ìƒ
            **ì§‘ì¤‘ ì˜ì—­**: ${{ steps.scope.outputs.focus_area }}
            
            **ìˆ˜í–‰í•  ì‘ì—…:**
            1. **ì½”ë“œ ë¶„ì„**
               - ì½”ë“œ ìŠ¤ë©œ íƒì§€ (ê¸´ í•¨ìˆ˜, ì¤‘ë³µ ì½”ë“œ, ë³µì¡í•œ ì¡°ê±´ë¬¸)
               - ì„±ëŠ¥ ë³‘ëª© ì§€ì  íŒŒì•…
               - ë³´ì•ˆ ì·¨ì•½ì  í™•ì¸
               - ê°€ë…ì„± ì €í•˜ ìš”ì†Œ ì‹ë³„
            
            2. **ë¦¬íŒ©í† ë§ ê³„íš ìˆ˜ë¦½**
               - ìš°ì„ ìˆœìœ„ë³„ ê°œì„  í•­ëª© ì •ë¦¬
               - ë¦¬íŒ©í† ë§ ì „í›„ ë¹„êµ ê³„íš
               - í…ŒìŠ¤íŠ¸ ì˜í–¥ë„ ë¶„ì„
            
            3. **ë¦¬íŒ©í† ë§ ì‹¤í–‰**
               - **ì„±ëŠ¥ ê°œì„ **: ë¹„íš¨ìœ¨ì ì¸ ì•Œê³ ë¦¬ì¦˜ ìµœì í™”
               - **ê°€ë…ì„± í–¥ìƒ**: í•¨ìˆ˜ ë¶„í• , ë³€ìˆ˜ëª… ê°œì„ , ì£¼ì„ ì¶”ê°€
               - **ì½”ë“œ ì¤‘ë³µ ì œê±°**: ê³µí†µ í•¨ìˆ˜ ì¶”ì¶œ, ìœ í‹¸ë¦¬í‹° ëª¨ë“ˆí™”
               - **êµ¬ì¡° ê°œì„ **: í´ë˜ìŠ¤/ëª¨ë“ˆ ì¬êµ¬ì„±, ì˜ì¡´ì„± ì •ë¦¬
               - **í˜„ëŒ€ì  íŒ¨í„´**: ES6+, async/await, type annotations ì ìš©
            
            4. **í…ŒìŠ¤íŠ¸ ë³´ì¥**
               - ê¸°ì¡´ í…ŒìŠ¤íŠ¸ê°€ ì—¬ì „íˆ í†µê³¼í•˜ëŠ”ì§€ í™•ì¸
               - í•„ìš”ì‹œ í…ŒìŠ¤íŠ¸ ì½”ë“œë„ í•¨ê»˜ ë¦¬íŒ©í† ë§
            
            **ì¶œë ¥ í˜•ì‹:**
            ```
            ## ğŸ”§ ë¦¬íŒ©í† ë§ ì™„ë£Œ ë³´ê³ ì„œ
            
            ### ğŸ“Š ë¶„ì„ ê²°ê³¼
            #### ğŸš¨ ë°œê²¬ëœ ë¬¸ì œì :
            - **ì„±ëŠ¥**: [ëŠë¦° ë¶€ë¶„ë“¤]
            - **ê°€ë…ì„±**: [ì´í•´í•˜ê¸° ì–´ë ¤ìš´ ì½”ë“œ]
            - **ì¤‘ë³µ**: [ì¤‘ë³µëœ ì½”ë“œ ë¸”ë¡ë“¤]
            - **ë³µì¡ë„**: [ë„ˆë¬´ ë³µì¡í•œ í•¨ìˆ˜ë“¤]
            
            ### ğŸ› ï¸ ì‹¤í–‰ëœ ë¦¬íŒ©í† ë§
            #### ğŸ“ ìˆ˜ì •ëœ íŒŒì¼:
            - `íŒŒì¼ëª…`: [êµ¬ì²´ì ì¸ ê°œì„  ë‚´ìš©]
              - Before: [ê¸°ì¡´ ì½”ë“œ íŠ¹ì§•]
              - After: [ê°œì„ ëœ ì ]
              - íš¨ê³¼: [ì„±ëŠ¥/ê°€ë…ì„± ê°œì„  íš¨ê³¼]
            
            ### ğŸ“ˆ ê°œì„  íš¨ê³¼
            - **ì„±ëŠ¥ í–¥ìƒ**: [êµ¬ì²´ì ì¸ ê°œì„  ìˆ˜ì¹˜]
            - **ê°€ë…ì„± ê°œì„ **: [ë³µì¡ë„ ê°ì†Œ, ë¼ì¸ ìˆ˜ ìµœì í™”]
            - **ìœ ì§€ë³´ìˆ˜ì„±**: [ëª¨ë“ˆí™”, ì¬ì‚¬ìš©ì„± í–¥ìƒ]
            - **ë³´ì•ˆ ê°•í™”**: [ì·¨ì•½ì  ìˆ˜ì •]
            
            ### âœ… í…ŒìŠ¤íŠ¸ ê²°ê³¼
            - ê¸°ì¡´ í…ŒìŠ¤íŠ¸: [í†µê³¼/ì‹¤íŒ¨ í˜„í™©]
            - ìƒˆë¡œìš´ í…ŒìŠ¤íŠ¸: [ì¶”ê°€ëœ í…ŒìŠ¤íŠ¸]
            
            ### ğŸ¯ ì¶”ê°€ ê¶Œì¥ì‚¬í•­
            - [í–¥í›„ ì½”ë“œ í’ˆì§ˆ ìœ ì§€ ë°©ë²•]
            - [ì •ê¸°ì ì¸ ë¦¬íŒ©í† ë§ ê°€ì´ë“œ]
            - [íŒ€ ì½”ë”© ìŠ¤íƒ€ì¼ ê°€ì´ë“œ ì œì•ˆ]
            ```
            
            **ë¦¬íŒ©í† ë§ ì›ì¹™:**
            - ê¸°ëŠ¥ ë³€ê²½ ì—†ì´ êµ¬ì¡°ë§Œ ê°œì„ 
            - í…ŒìŠ¤íŠ¸ í†µê³¼ ë³´ì¥
            - í•œ ë²ˆì— ë„ˆë¬´ ë§ì´ ë³€ê²½í•˜ì§€ ì•Šê¸°
            - ë°±ì›Œë“œ í˜¸í™˜ì„± ìœ ì§€
            - ì„±ëŠ¥ ì €í•˜ ë°©ì§€
            
            **ì§‘ì¤‘ ì˜ì—­ë³„ ì„¸ë¶€ ê°€ì´ë“œ:**
            - **performance**: ì•Œê³ ë¦¬ì¦˜ ìµœì í™”, ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê°œì„ , ìºì‹± ì¶”ê°€
            - **readability**: í•¨ìˆ˜ ë¶„í• , ëª…ëª… ê°œì„ , ì£¼ì„ ì¶”ê°€, êµ¬ì¡° ë‹¨ìˆœí™”
            - **maintainability**: ëª¨ë“ˆí™”, ì˜ì¡´ì„± ì •ë¦¬, ì„¤ê³„ íŒ¨í„´ ì ìš©
            - **security**: ì…ë ¥ ê²€ì¦, ë³´ì•ˆ í•¨ìˆ˜ ì‚¬ìš©, ì·¨ì•½ì  íŒ¨ì¹˜
            - **all**: ìœ„ ëª¨ë“  ì˜ì—­ì„ ê· í˜•ìˆê²Œ ê°œì„ 
            
          allowed_tools: "Read,Write,Edit,MultiEdit,Grep,Bash(npm test),Bash(npm run lint),Bash(npm run build)"
          
          settings: |
            {
              "enableAllProjectMcpServers": true,
              "customInstructions": "í•œêµ­ì–´ë¡œ ìƒì„¸í•œ ë¦¬íŒ©í† ë§ ë¶„ì„ ì œê³µ. ì•ˆì „í•˜ê³  ì ì§„ì ì¸ ê°œì„ . í…ŒìŠ¤íŠ¸ ë³´ì¥."
            }
            
          timeout_minutes: "30"
          anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}

      - name: Run tests after refactoring
        id: test-refactored
        run: |
          echo "ğŸ§ª ë¦¬íŒ©í† ë§ í›„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰..."
          
          # í”„ë¡œì íŠ¸ì— ë§ëŠ” í…ŒìŠ¤íŠ¸ ëª…ë ¹ì–´ ì‹¤í–‰
          if [ -f "package.json" ]; then
            if npm list --depth=0 2>/dev/null | grep -q "jest\|mocha\|vitest"; then
              npm test || echo "í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨"
            fi
          elif [ -f "pytest.ini" ] || [ -f "setup.py" ]; then
            if command -v pytest &> /dev/null; then
              pytest || echo "í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨"
            fi
          elif [ -f "go.mod" ]; then
            go test ./... || echo "í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨"
          fi
          
          echo "í…ŒìŠ¤íŠ¸ ì™„ë£Œ"

      - name: Check for refactoring changes
        id: check-changes
        run: |
          if git diff --quiet && git diff --cached --quiet; then
            echo "ë¦¬íŒ©í† ë§ ë³€ê²½ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤."
            echo "has_changes=false" >> $GITHUB_OUTPUT
          else
            echo "has_changes=true" >> $GITHUB_OUTPUT
            echo "ğŸ”§ ë¦¬íŒ©í† ë§ëœ íŒŒì¼:"
            git diff --name-only
            
            # ë³€ê²½ì‚¬í•­ í†µê³„
            echo "ğŸ“Š ë³€ê²½ í†µê³„:"
            echo "- ìˆ˜ì •ëœ íŒŒì¼: $(git diff --name-only | wc -l)ê°œ"
            echo "- ì¶”ê°€ëœ ë¼ì¸: +$(git diff --numstat | awk '{add+=$1} END {print add}')"
            echo "- ì‚­ì œëœ ë¼ì¸: -$(git diff --numstat | awk '{del+=$2} END {print del}')"
          fi

      - name: Create refactoring branch
        if: steps.check-changes.outputs.has_changes == 'true'
        run: |
          # ë¦¬íŒ©í† ë§ ë¸Œëœì¹˜ ìƒì„±
          BRANCH_NAME="refactor/auto-improvement-$(date +%Y%m%d-%H%M%S)"
          
          git config user.name "Claude AI Refactoring Bot"
          git config user.email "claude-refactor@anthropic.com"
          git checkout -b "$BRANCH_NAME"
          
          echo "refactor_branch=$BRANCH_NAME" >> $GITHUB_OUTPUT
        id: create-refactor-branch

      - name: Commit refactoring changes
        if: steps.check-changes.outputs.has_changes == 'true'
        run: |
          git add -A
          git commit -m "ğŸ”§ Refactor: Code quality improvements

          Auto-generated refactoring focused on: ${{ steps.scope.outputs.focus_area }}
          
          âœ¨ Improvements:
          - Enhanced code readability and maintainability
          - Optimized performance bottlenecks
          - Reduced code duplication
          - Applied modern coding patterns
          - Improved error handling
          
          ğŸ§ª Testing: All existing tests maintained
          
          ğŸ¤– Generated by Claude AI Refactoring Assistant
          Co-authored-by: Claude AI <claude@anthropic.com>"
          
          git push origin "${{ steps.create-refactor-branch.outputs.refactor_branch }}"

      - name: Create Refactoring PR
        if: steps.check-changes.outputs.has_changes == 'true'
        uses: actions/github-script@v6
        with:
          script: |
            const fs = require('fs');
            
            // Claude ì‹¤í–‰ ê²°ê³¼ ì½ê¸°
            let claudeOutput = "ë¦¬íŒ©í† ë§ ì™„ë£Œ";
            try {
              const logFile = '${{ steps.claude-refactor.outputs.execution_file }}';
              if (fs.existsSync(logFile)) {
                const logData = JSON.parse(fs.readFileSync(logFile, 'utf8'));
                claudeOutput = logData.result || "ë¦¬íŒ©í† ë§ ì™„ë£Œ";
              }
            } catch (error) {
              console.log('ë¡œê·¸ íŒŒì‹± ì˜¤ë¥˜:', error);
            }

            const prBody = `## ğŸ”§ ìë™ ì½”ë“œ ë¦¬íŒ©í† ë§

ì´ PRì€ Claude AIê°€ ì½”ë“œ í’ˆì§ˆ ë¶„ì„ì„ í†µí•´ ìë™ìœ¼ë¡œ ìƒì„±í•œ ë¦¬íŒ©í† ë§ ê°œì„ ì‚¬í•­ì…ë‹ˆë‹¤.

### ğŸ¯ ë¦¬íŒ©í† ë§ ì˜ì—­
**ì§‘ì¤‘ ì˜ì—­**: ${{ steps.scope.outputs.focus_area }}

### ğŸ“‹ ê°œì„  ë‚´ì—­

${claudeOutput}

### ğŸ§ª í…ŒìŠ¤íŠ¸ ìƒíƒœ
- [x] ê¸°ì¡´ í…ŒìŠ¤íŠ¸ ìœ ì§€
- [x] ê¸°ëŠ¥ ë™ì‘ ë³´ì¥
- [x] ì„±ëŠ¥ ê²€ì¦

### ğŸ” ê²€í†  ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] ì½”ë“œ ë¦¬ë·° ì™„ë£Œ
- [ ] ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ í™•ì¸
- [ ] ë³´ì•ˆ ê²€í†  ì™„ë£Œ
- [ ] ë¬¸ì„œ ì—…ë°ì´íŠ¸ í™•ì¸

### âš ï¸ ì£¼ì˜ì‚¬í•­
- ì´ ë¦¬íŒ©í† ë§ì€ AIê°€ ìƒì„±í–ˆìœ¼ë¯€ë¡œ **ë°˜ë“œì‹œ ì‚¬ëŒì˜ ê²€í† **ê°€ í•„ìš”í•©ë‹ˆë‹¤
- í”„ë¡œë•ì…˜ ë°°í¬ ì „ ì¶©ë¶„í•œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ì£¼ì„¸ìš”
- ì˜ˆìƒì¹˜ ëª»í•œ ë™ì‘ ë³€ê²½ì´ ìˆì„ ìˆ˜ ìˆìœ¼ë‹ˆ ì£¼ì˜ ê¹Šê²Œ ê²€í† í•´ì£¼ì„¸ìš”

### ğŸš€ ë°°í¬ ê°€ì´ë“œ
1. ì½”ë“œ ë¦¬ë·° ë° ìŠ¹ì¸
2. ê°œë°œ/ìŠ¤í…Œì´ì§• í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸
3. ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ì„¤ì •
4. í”„ë¡œë•ì…˜ ë°°í¬

---
**ğŸ¤– Generated by Claude AI Refactoring Assistant**`;

            const pr = await github.rest.pulls.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: `ğŸ”§ Refactor: Code quality improvements (${{ steps.scope.outputs.focus_area }})`,
              head: '${{ steps.create-refactor-branch.outputs.refactor_branch }}',
              base: 'main',
              body: prBody,
              draft: false
            });

            console.log(`Created PR #${pr.data.number}`);

            // ë¦¬íŒ©í† ë§ ê²°ê³¼ë¥¼ ì´ìŠˆë‚˜ ì½”ë©˜íŠ¸ì— ì•Œë¦¼
            if ('${{ github.event_name }}' === 'issue_comment') {
              await github.rest.issues.createComment({
                issue_number: ${{ github.event.issue.number }},
                owner: context.repo.owner,
                repo: context.repo.repo,
                body: `ğŸ”§ **ë¦¬íŒ©í† ë§ ì™„ë£Œ!**\n\nClaude AIê°€ ì½”ë“œ ë¦¬íŒ©í† ë§ì„ ìˆ˜í–‰í•˜ê³  PR #${pr.data.number}ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤.\n\n**ì§‘ì¤‘ ì˜ì—­**: ${{ steps.scope.outputs.focus_area }}\n\nâš ï¸ AIê°€ ìƒì„±í•œ ì½”ë“œì´ë¯€ë¡œ ë°˜ë“œì‹œ ë¦¬ë·° í›„ ë¨¸ì§€í•´ì£¼ì„¸ìš”.`
              });
            }

      - name: No changes notification
        if: steps.check-changes.outputs.has_changes == 'false'
        uses: actions/github-script@v6
        with:
          script: |
            if ('${{ github.event_name }}' === 'issue_comment') {
              await github.rest.issues.createComment({
                issue_number: ${{ github.event.issue.number }},
                owner: context.repo.owner,
                repo: context.repo.repo,
                body: `âœ… **ë¦¬íŒ©í† ë§ ê²€í†  ì™„ë£Œ**\n\nClaude AIê°€ ì½”ë“œë¥¼ ë¶„ì„í•œ ê²°ê³¼, í˜„ì¬ ì½”ë“œê°€ ì–‘í˜¸í•œ ìƒíƒœë¡œ ì¶”ê°€ ë¦¬íŒ©í† ë§ì´ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n\n**ì§‘ì¤‘ ì˜ì—­**: ${{ steps.scope.outputs.focus_area }}`
              });
            }

      - name: Upload refactoring log
        if: always()
        uses: actions/upload-artifact@v3
        with:
          name: claude-refactor-log-${{ github.run_number }}
          path: |
            ${{ steps.claude-refactor.outputs.execution_file }}
            code_analysis.md
            files_to_analyze.txt
          retention-days: 30

      - name: Generate refactoring report
        if: always()
        run: |
          echo "ğŸ“Š ë¦¬íŒ©í† ë§ ì‘ì—… ì™„ë£Œ ë³´ê³ ì„œ" > refactoring_summary.md
          echo "================================" >> refactoring_summary.md
          echo "" >> refactoring_summary.md
          echo "**ì‹¤í–‰ ì‹œê°„**: $(date)" >> refactoring_summary.md
          echo "**íŠ¸ë¦¬ê±°**: ${{ github.event_name }}" >> refactoring_summary.md
          echo "**ì§‘ì¤‘ ì˜ì—­**: ${{ steps.scope.outputs.focus_area }}" >> refactoring_summary.md
          echo "**ë³€ê²½ì‚¬í•­**: ${{ steps.check-changes.outputs.has_changes }}" >> refactoring_summary.md
          echo "**ì‹¤í–‰ ê²°ê³¼**: ${{ steps.claude-refactor.outputs.conclusion }}" >> refactoring_summary.md
          echo "" >> refactoring_summary.md
          
          if [ "${{ steps.check-changes.outputs.has_changes }}" = "true" ]; then
            echo "ğŸ‰ ì„±ê³µì ìœ¼ë¡œ ë¦¬íŒ©í† ë§ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!" >> refactoring_summary.md
            echo "PR: ${{ steps.create-refactor-branch.outputs.refactor_branch }}" >> refactoring_summary.md
          else
            echo "â„¹ï¸ ë¦¬íŒ©í† ë§í•  í•­ëª©ì´ ë°œê²¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤." >> refactoring_summary.md
          fi
          
          cat refactoring_summary.md